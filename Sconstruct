third_party_path = '#/../third_party'
cpp_path = [
  '#',
  third_party_path + '/boost/include/boost-1_39',
  third_party_path + '/gflags/include',
  third_party_path + '/pcre/include',
  third_party_path + '/glog/include',
]

lib_path = [
  third_party_path + '/boost/lib',
  third_party_path + '/gflags/lib',
  third_party_path + '/pcre/lib',
  third_party_path + '/glog/lib',
  '#build/base',
  '#build/server',
]

libs = [  'glog',
          'gflags',
	  'pcre',
	  'pcrecpp',
	  'pthread',
	  'boost_system-gcc42-mt',
	  'boost_thread-gcc42-mt']

env = DefaultEnvironment()
env.Append(CPPFLAGS='-g -static')
env.Append(LINKFLAGS='-g -static')
env.Append(LIBS=libs)
env.Append(CPPPATH=cpp_path)
env.Append(LIBPATH=lib_path)

def Test(name):
  Program(name + "_test.cc", LIBS=['base', 'gtest', 'gtest_main'])

import __builtin__
__builtin__.Test = Test

subdir=['base', 'server', 'linux_client']
for x in subdir:
  target_dir='build/%s' % x
  SConscript('%s/SConscript' % x, build_dir=target_dir, duplicate=0)
